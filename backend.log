
> accubooks-enterprise@1.0.0 start:dev
> cross-env NODE_ENV=development nodemon --exec tsx server/index.ts

[33m[nodemon] 3.1.10[39m
[33m[nodemon] to restart at any time, enter `rs`[39m
[33m[nodemon] watching path(s): *.*[39m
[33m[nodemon] watching extensions: ts,json[39m
[32m[nodemon] starting `tsx server/index.ts`[39m
[dotenv@17.2.3] injecting env (131) from .env -- tip: üîë add access controls to secrets: https://dotenvx.com/ops
Connecting to Redis at: localhost port: 6379
[2026-02-02T22:01:33.202Z] INFO: Stripe initialized 
‚ö†Ô∏è  Environment variable warnings:
   - Recommended variable OWNER_EMAIL is not set
   - Recommended variable REDIS_PASSWORD is not set
‚úÖ Environment variables validated successfully
üìã Environment: development
üìã Database: localhost:5432/chronaworkflow
üìã Frontend URL: http://localhost:3000
üìã Server: localhost:5000
‚ö†Ô∏è  Database connection failed: connect ECONNREFUSED 127.0.0.1:5432
‚ö†Ô∏è  Server will start in degraded mode. Database-dependent routes will return 503.
‚ö†Ô∏è  Starting server without database connection
‚ö†Ô∏è  Database error: connect ECONNREFUSED 127.0.0.1:5432
Redis connection error: connect ECONNREFUSED 127.0.0.1:6379
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
‚ö†Ô∏è  Redis unavailable: Connection is closed.
‚ö†Ô∏è  Job queues will be disabled. Backend will continue without background jobs.
Redis connection error: connect ECONNREFUSED 127.0.0.1:6379
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Redis connection error: connect ECONNREFUSED 127.0.0.1:6379
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
üü° Registered high-risk route: POST /api/customers [createCustomer] (HIGH)
üü° Registered high-risk route: PATCH /api/customers/:id [updateCustomer] (HIGH)
‚úì Registered financial route: POST /api/payments [createPayment]
‚úì Registered financial route: POST /api/bank-transactions/import [importBankTransactions]
‚úì Registered financial route: POST /api/bank-transactions/:id/reconcile [reconcileBankTransaction]
üî¥ Registered high-risk route: POST /api/payroll/employees [createEmployee] (CRITICAL)
‚úì Registered financial route: PATCH /api/payroll/employees/:id [updateEmployee]
‚úì Registered financial route: POST /api/payroll/deductions [createDeduction]
‚úì Registered financial route: POST /api/payroll/employee-deductions [createEmployeeDeduction]
‚úì Registered financial route: POST /api/payroll/periods [createPayrollPeriod]
‚úì Registered financial route: POST /api/payroll/time-entries [createTimeEntry]
‚úì Registered financial route: POST /api/payroll/time-entries/:id/approve [approveTimeEntry]
‚úì Registered financial route: POST /api/payroll/pay-runs [createPayRun]
‚úì Registered financial route: PATCH /api/payroll/pay-runs/:id/status [updatePayRunStatus]
‚úì Registered financial route: POST /api/payroll/tax-forms [createTaxForm]
üü° Registered high-risk route: POST /api/inventory/items [createInventoryItem] (HIGH)
üü° Registered high-risk route: PATCH /api/inventory/items/:id [updateInventoryItem] (HIGH)
‚úì Registered financial route: PATCH /api/inventory/items/:id/quantity [updateInventoryQuantity]
‚úì Registered financial route: POST /api/inventory/purchase-orders [createPurchaseOrder]
‚úì Registered financial route: PATCH /api/inventory/purchase-orders/:id/status [updatePurchaseOrderStatus]
‚úì Registered financial route: POST /api/inventory/adjustments [createInventoryAdjustment]
‚úÖ API routes registered successfully
 AccuBooks server running on http://localhost:5000
Environment: development
Startup duration: 653ms
Redis connection error: connect ECONNREFUSED 127.0.0.1:6379
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
‚ö†Ô∏è  Redis connection failed after 3 attempts. Job queues will be disabled.
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
[2026-02-02T22:01:36.255Z] WARN: Redis connection closed. Job queues disabled. 
[2026-02-02T22:01:36.258Z] WARN: Redis not available. Skipping job queue initialization. 
{"level":"info","component":"server.http","message":"request","data":{"requestId":"aba4629b-8406-46e4-aff6-61caaf49ba09","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":6},"timestamp":"2026-02-02T22:01:37.108Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"2e687502-6f42-46e6-8e13-c8ac368b9fbe","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":2},"timestamp":"2026-02-02T22:01:39.155Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"429ce0f4-4d9b-4590-904e-9f20ebf066eb","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":2},"timestamp":"2026-02-02T22:01:41.221Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"f454320e-218b-4b1e-848b-38a8c7950533","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":1},"timestamp":"2026-02-02T22:01:42.514Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"45ee554b-7c08-45f5-a6d4-122425781aed","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":2},"timestamp":"2026-02-02T22:01:44.572Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"f0f36bba-bc38-41cc-b211-61765bc67320","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":1},"timestamp":"2026-02-02T22:01:46.651Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"69bb061d-9826-4e47-a74b-d9f0ff1b3a13","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":1},"timestamp":"2026-02-02T22:01:48.722Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"4fa62de5-0f39-4379-beeb-d45c31510aea","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":1},"timestamp":"2026-02-02T22:01:50.775Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"bbd5c512-2469-433e-8a81-eb14ef2ae92a","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":2},"timestamp":"2026-02-02T22:01:52.834Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"fb8a0d40-7673-4f99-a033-74af5610b6eb","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":1},"timestamp":"2026-02-02T22:01:54.890Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"eaca4423-483b-4ed4-b7d2-7e0b3f10ddde","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":1},"timestamp":"2026-02-02T22:01:56.939Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"f89d097c-5810-4387-9344-2edd1903e845","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":1},"timestamp":"2026-02-02T22:01:58.972Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"fafd928a-6453-4d04-9617-7f98f361ec94","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":2},"timestamp":"2026-02-02T22:02:01.011Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"b3e1ecdb-e77b-4c05-a854-157f5fdc62f6","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":1},"timestamp":"2026-02-02T22:02:03.071Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"7666f9f3-b318-4b22-a84d-8431186590aa","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":1},"timestamp":"2026-02-02T22:02:05.132Z","environment":"development"}
