
> accubooks-enterprise@1.0.0 start:dev
> cross-env NODE_ENV=development nodemon --exec tsx server/index.ts

[33m[nodemon] 3.1.10[39m
[33m[nodemon] to restart at any time, enter `rs`[39m
[33m[nodemon] watching path(s): *.*[39m
[33m[nodemon] watching extensions: ts,json[39m
[32m[nodemon] starting `tsx server/index.ts`[39m
[dotenv@17.2.3] injecting env (131) from .env -- tip: ‚öôÔ∏è  override existing env vars with { override: true }
Connecting to Redis at: localhost port: 6379
[2026-02-02T22:04:14.629Z] INFO: Stripe initialized 
‚ö†Ô∏è  Environment variable warnings:
   - Recommended variable OWNER_EMAIL is not set
   - Recommended variable REDIS_PASSWORD is not set
‚úÖ Environment variables validated successfully
üìã Environment: development
üìã Database: localhost:5432/chronaworkflow
üìã Frontend URL: http://localhost:3000
üìã Server: localhost:5000
‚ö†Ô∏è  Database connection failed: connect ECONNREFUSED 127.0.0.1:5432
‚ö†Ô∏è  Server will start in degraded mode. Database-dependent routes will return 503.
‚ö†Ô∏è  Starting server without database connection
‚ö†Ô∏è  Database error: connect ECONNREFUSED 127.0.0.1:5432
Redis connection error: connect ECONNREFUSED 127.0.0.1:6379
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
‚ö†Ô∏è  Redis unavailable: Connection is closed.
‚ö†Ô∏è  Job queues will be disabled. Backend will continue without background jobs.
Redis connection error: connect ECONNREFUSED 127.0.0.1:6379
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
üü° Registered high-risk route: POST /api/customers [createCustomer] (HIGH)
üü° Registered high-risk route: PATCH /api/customers/:id [updateCustomer] (HIGH)
‚úì Registered financial route: POST /api/payments [createPayment]
‚úì Registered financial route: POST /api/bank-transactions/import [importBankTransactions]
‚úì Registered financial route: POST /api/bank-transactions/:id/reconcile [reconcileBankTransaction]
üî¥ Registered high-risk route: POST /api/payroll/employees [createEmployee] (CRITICAL)
‚úì Registered financial route: PATCH /api/payroll/employees/:id [updateEmployee]
‚úì Registered financial route: POST /api/payroll/deductions [createDeduction]
‚úì Registered financial route: POST /api/payroll/employee-deductions [createEmployeeDeduction]
‚úì Registered financial route: POST /api/payroll/periods [createPayrollPeriod]
‚úì Registered financial route: POST /api/payroll/time-entries [createTimeEntry]
‚úì Registered financial route: POST /api/payroll/time-entries/:id/approve [approveTimeEntry]
‚úì Registered financial route: POST /api/payroll/pay-runs [createPayRun]
‚úì Registered financial route: PATCH /api/payroll/pay-runs/:id/status [updatePayRunStatus]
‚úì Registered financial route: POST /api/payroll/tax-forms [createTaxForm]
üü° Registered high-risk route: POST /api/inventory/items [createInventoryItem] (HIGH)
üü° Registered high-risk route: PATCH /api/inventory/items/:id [updateInventoryItem] (HIGH)
‚úì Registered financial route: PATCH /api/inventory/items/:id/quantity [updateInventoryQuantity]
‚úì Registered financial route: POST /api/inventory/purchase-orders [createPurchaseOrder]
‚úì Registered financial route: PATCH /api/inventory/purchase-orders/:id/status [updatePurchaseOrderStatus]
‚úì Registered financial route: POST /api/inventory/adjustments [createInventoryAdjustment]
‚úÖ API routes registered successfully
Redis connection error: connect ECONNREFUSED 127.0.0.1:6379
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
 AccuBooks server running on http://localhost:5000
Environment: development
Startup duration: 614ms
Redis connection error: connect ECONNREFUSED 127.0.0.1:6379
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
‚ö†Ô∏è  Redis connection failed after 3 attempts. Job queues will be disabled.
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
Error: connect ECONNREFUSED 127.0.0.1:6379
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1611:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '127.0.0.1',
  port: 6379
}
[2026-02-02T22:04:17.432Z] WARN: Redis connection closed. Job queues disabled. 
[2026-02-02T22:04:17.438Z] WARN: Redis not available. Skipping job queue initialization. 
{"level":"info","component":"server.http","message":"request","data":{"requestId":"497c4629-56f1-4757-88b0-a2c28f079559","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":7},"timestamp":"2026-02-02T22:04:17.869Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"199008c9-9b6f-4bda-9235-53bf3d05c2ff","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":1},"timestamp":"2026-02-02T22:04:19.908Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"5a2a557e-330a-4b7a-954c-5dca021e707b","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":1},"timestamp":"2026-02-02T22:04:21.213Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"f25ab525-ed9b-43ea-b604-8dc567a63583","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":2},"timestamp":"2026-02-02T22:04:23.269Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"6b4e9f9b-824f-457d-b697-9079fe4dd60f","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":1},"timestamp":"2026-02-02T22:04:25.312Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"1aa96c2d-739d-45f8-ac54-a9ed8653de1a","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":1},"timestamp":"2026-02-02T22:04:27.351Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"8eedf70e-4fe4-4009-8050-7261caa1093f","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":2},"timestamp":"2026-02-02T22:04:29.393Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"52f65f43-dc34-4a75-8155-4542d4b9c5a1","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":2},"timestamp":"2026-02-02T22:04:31.455Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"a976ce35-1d76-4a3d-8e0a-2d7454fa41d5","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":2},"timestamp":"2026-02-02T22:04:33.505Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"4468cd83-ea24-438e-8afb-f052e7c94de9","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":1},"timestamp":"2026-02-02T22:04:35.562Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"1a8034c7-2544-432f-a043-b05621155b80","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":1},"timestamp":"2026-02-02T22:04:37.605Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"89dd0e98-2a57-4511-8d61-3d4d4b37797a","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":1},"timestamp":"2026-02-02T22:04:39.640Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"9a7802d6-bb8f-4516-870a-caa92989c45c","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":1},"timestamp":"2026-02-02T22:04:41.676Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"f11d7173-27ec-4dd5-92aa-ab6f3b25b25d","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":2},"timestamp":"2026-02-02T22:04:43.740Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"673f422a-6df1-4a60-889c-bb225bc998c4","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":2},"timestamp":"2026-02-02T22:04:45.785Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"b160ce83-eb63-4944-be71-e888bed2d876","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":1},"timestamp":"2026-02-02T22:04:47.827Z","environment":"development"}
{"level":"info","component":"server.http","message":"request","data":{"requestId":"052b05ec-795b-4b6d-8ef2-4cb11ce0839f","method":"GET","path":"/api/monitoring/health","statusCode":401,"durationMs":1},"timestamp":"2026-02-02T22:04:49.868Z","environment":"development"}
